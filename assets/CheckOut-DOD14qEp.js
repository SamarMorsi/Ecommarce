import{u as f,r as a,C as y,j as e,a as i,V as d}from"./index-N25QuTE4.js";import{c as g,a as l,u as j}from"./index.esm-BnNRfZoi.js";import{H as C}from"./Helmet-Bs7vAENK.js";function N(){let c=f(),[u,n]=a.useState(!0),m=g().shape({details:l().required("details is required").min(3,"min 3 letters"),phone:l().required("phone is required").matches(/^01[01257][0-9]{8}$/,"invalid phone"),city:l().required("city is required")}),{cartId:o,resetCart:h}=a.useContext(y);console.log(o,"id");function p(r){i.post(`https://ecommerce.routemisr.com/api/v1/orders/${o}`,{shippingAddress:r},{headers:{token:localStorage.getItem("usertoken")}}).then(t=>{console.log(t),t.data.status==="success"?(d.success("check out done ....",{position:"top-right",style:{backgroundColor:"#479747",color:"#FFFFFF",padding:"20px",borderRadius:"5px"},icon:"👌"}),h(),c("/allorders")):d.error("check out failed ....",{position:"top-right",style:{backgroundColor:"#479747",color:"#FFFFFF",padding:"20px",borderRadius:"5px"},icon:"❗"})}).catch(t=>{console.log(t)})}function x(r){i.post(`https://ecommerce.routemisr.com/api/v1/orders/checkout-session/${o}?url=${window.location.origin}`,{shippingAddress:r},{headers:{token:localStorage.getItem("usertoken")}}).then(t=>{console.log(t),t.data.status==="success"&&(console.log(t.data.session.url),window.location.href=t.data.session.url)}).catch(t=>{console.log(t)})}function b(r){u?x(r):p(r)}let s=j({initialValues:{details:"",phone:"",city:""},validationSchema:m,onSubmit:b});return e.jsxs(e.Fragment,{children:[e.jsx(C,{children:e.jsx("title",{children:"Checkout"})}),e.jsx("div",{className:" flex h-screen py-10 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"w-full  space-y-8",children:e.jsx("div",{className:"bg-white  rounded-md p-6",children:e.jsxs("form",{onSubmit:s.handleSubmit,className:" space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"details",className:"block text-sm font-medium text-gray-700 ",children:"Details"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{value:s.values.details,onBlur:s.handleBlur,onChange:s.handleChange,id:"details",name:"details",type:"text",autoComplete:"details",className:"px-2 py-3 mt-1 block w-full rounded-md border border-gray-300 shadow-sm focus:border-[#C2DBFE] focus:transition-all  focus:border-4 focus:outline-none focus:ring-green-500 sm:text-sm"})}),s.errors.details&&s.touched.details?e.jsx("h5",{className:"bg-red-100 mt-2 py-4 ps-3 text-red-500 border border-red-300 rounded",children:s.errors.details}):null]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 ",children:"Phone"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{value:s.values.phone,onBlur:s.handleBlur,onChange:s.handleChange,id:"phone",name:"phone",type:"tel",autoComplete:"phone",className:"px-2 py-3 mt-1 block w-full rounded-md border border-gray-300 shadow-sm focus:border-[#C2DBFE] focus:transition-all  focus:border-4 focus:outline-none focus:ring-green-500 sm:text-sm"})}),s.errors.phone&&s.touched.phone?e.jsx("h5",{className:"bg-red-100 mt-2 py-4 ps-3 text-red-500 border border-red-300 rounded",children:s.errors.phone}):null]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 ",children:"City"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{value:s.values.city,onBlur:s.handleBlur,onChange:s.handleChange,id:"city",name:"city",type:"text",autoComplete:"city",className:"px-2 py-3 mt-1 block w-full rounded-md border border-gray-300 shadow-sm focus:border-[#C2DBFE] focus:transition-all  focus:border-4 focus:outline-none focus:ring-green-500 sm:text-sm"})}),s.errors.city&&s.touched.city?e.jsx("h5",{className:"bg-red-100 mt-2 py-4 ps-3 text-red-500 border border-red-300 rounded",children:s.errors.city}):null]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>{n(!1)},type:"submit",className:"flex w-full justify-center rounded-md border mb-3 border-outline-none py-2 border-sky-300 px-4 text-l font-medium text-sky-300 cursor-pointer ",children:"Pay Cash"}),e.jsx("button",{onClick:()=>{n(!0)},type:"submit",className:"flex w-full justify-center rounded-md border  border-outline-none py-2 border-sky-300 px-4 text-l font-medium text-sky-300 cursor-pointer ",children:"Pay Online"})]})]})})})})]})}export{N as default};
